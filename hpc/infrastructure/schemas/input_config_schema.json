{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Globtim HPC Input Configuration Schema",
  "description": "Schema for capturing all input parameters needed to reproduce a Globtim computation",
  "type": "object",
  "required": ["metadata", "test_input", "polynomial_construction"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["computation_id", "timestamp", "function_name"],
      "properties": {
        "computation_id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]{8}$",
          "description": "8-character unique identifier for this computation"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when computation was initiated"
        },
        "function_name": {
          "type": "string",
          "description": "Name of the objective function being optimized"
        },
        "description": {
          "type": "string",
          "description": "Human-readable description of this computation"
        },
        "tags": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Tags for categorizing and searching computations"
        },
        "parent_computation_id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]{8}$",
          "description": "ID of parent computation if this is a refinement or continuation"
        }
      }
    },
    "test_input": {
      "type": "object",
      "required": ["function_name", "dimension", "center", "sample_range"],
      "properties": {
        "function_name": {
          "type": "string",
          "description": "Name of the objective function"
        },
        "dimension": {
          "type": "integer",
          "minimum": 1,
          "maximum": 20,
          "description": "Problem dimension"
        },
        "center": {
          "type": "array",
          "items": {"type": "number"},
          "description": "Center point of the search domain"
        },
        "sample_range": {
          "oneOf": [
            {"type": "number", "minimum": 0},
            {
              "type": "array",
              "items": {"type": "number", "minimum": 0}
            }
          ],
          "description": "Sampling radius (scalar or per-dimension vector)"
        },
        "GN": {
          "type": ["integer", "null"],
          "minimum": 10,
          "description": "Number of sample points for polynomial construction"
        },
        "tolerance": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Convergence tolerance"
        },
        "precision_params": {
          "type": ["object", "null"],
          "properties": {
            "alpha": {"type": "number"},
            "delta": {"type": "number"}
          },
          "description": "Precision parameters (alpha, delta) tuple"
        },
        "noise_params": {
          "type": ["object", "null"],
          "properties": {
            "noise_level": {"type": "number"},
            "noise_type": {"type": "string"}
          },
          "description": "Noise parameters for noisy function evaluation"
        },
        "reduce_samples": {
          "type": ["number", "null"],
          "minimum": 0,
          "maximum": 1,
          "description": "Sample reduction factor"
        },
        "degree_max": {
          "type": ["integer", "null"],
          "minimum": 1,
          "description": "Maximum polynomial degree"
        }
      }
    },
    "polynomial_construction": {
      "type": "object",
      "required": ["degree", "basis"],
      "properties": {
        "degree": {
          "type": "integer",
          "minimum": 1,
          "maximum": 20,
          "description": "Polynomial degree"
        },
        "basis": {
          "type": "string",
          "enum": ["chebyshev", "legendre"],
          "description": "Polynomial basis type"
        },
        "precision_type": {
          "type": "string",
          "enum": ["Float64Precision", "RationalPrecision", "BigFloatPrecision", "BigIntPrecision", "AdaptivePrecision"],
          "default": "RationalPrecision",
          "description": "Numerical precision type for polynomial construction"
        },
        "normalized": {
          "type": "boolean",
          "default": false,
          "description": "Whether to use normalized polynomial basis"
        },
        "power_of_two_denom": {
          "type": "boolean",
          "default": false,
          "description": "Whether to use power-of-two denominators for rational precision"
        },
        "verbose": {
          "type": "integer",
          "minimum": 0,
          "maximum": 2,
          "default": 0,
          "description": "Verbosity level for polynomial construction"
        }
      }
    },
    "critical_point_analysis": {
      "type": "object",
      "properties": {
        "tol_dist": {
          "type": "number",
          "minimum": 0,
          "default": 0.025,
          "description": "Distance tolerance for identifying distinct critical points"
        },
        "enable_hessian": {
          "type": "boolean",
          "default": true,
          "description": "Whether to perform Hessian-based critical point classification"
        },
        "max_iters_in_optim": {
          "type": "integer",
          "minimum": 1,
          "default": 100,
          "description": "Maximum iterations for BFGS optimization"
        },
        "hessian_tol_zero": {
          "type": "number",
          "minimum": 0,
          "default": 1e-8,
          "description": "Tolerance for zero eigenvalues in Hessian analysis"
        },
        "bfgs_g_tol": {
          "type": "number",
          "minimum": 0,
          "default": 1e-8,
          "description": "Gradient tolerance for BFGS convergence"
        },
        "bfgs_f_abstol": {
          "type": "number",
          "minimum": 0,
          "default": 1e-8,
          "description": "Function absolute tolerance for BFGS convergence"
        },
        "bfgs_x_abstol": {
          "type": "number",
          "minimum": 0,
          "default": 0.0,
          "description": "Variable absolute tolerance for BFGS convergence"
        },
        "verbose": {
          "type": "boolean",
          "default": true,
          "description": "Whether to print detailed analysis progress"
        }
      }
    },
    "computational_environment": {
      "type": "object",
      "properties": {
        "julia_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Julia version used for computation"
        },
        "globtim_version": {
          "type": "string",
          "description": "Globtim package version"
        },
        "hostname": {
          "type": "string",
          "description": "Hostname of the compute node"
        },
        "threads": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of Julia threads available"
        },
        "memory_limit": {
          "type": "string",
          "pattern": "^\\d+[GMK]B?$",
          "description": "Memory limit (e.g., '64G', '32GB')"
        },
        "time_limit": {
          "type": "string",
          "pattern": "^\\d{2}:\\d{2}:\\d{2}$",
          "description": "Time limit in HH:MM:SS format"
        },
        "slurm_job_id": {
          "type": ["string", "null"],
          "description": "SLURM job ID if running on cluster"
        },
        "partition": {
          "type": ["string", "null"],
          "description": "SLURM partition used"
        }
      }
    },
    "solver_configuration": {
      "type": "object",
      "properties": {
        "solver_backend": {
          "type": "string",
          "enum": ["HomotopyContinuation", "msolve"],
          "default": "HomotopyContinuation",
          "description": "Backend solver for polynomial system"
        },
        "solver_options": {
          "type": "object",
          "description": "Additional solver-specific options"
        }
      }
    }
  }
}
