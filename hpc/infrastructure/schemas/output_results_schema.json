{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Globtim HPC Output Results Schema",
  "description": "Schema for capturing all computational results and performance metrics from a Globtim computation",
  "type": "object",
  "required": ["metadata", "polynomial_results"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["computation_id", "timestamp_start", "timestamp_end", "status"],
      "properties": {
        "computation_id": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9]{8}$",
          "description": "8-character unique identifier matching input configuration"
        },
        "timestamp_start": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when computation started"
        },
        "timestamp_end": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when computation completed"
        },
        "total_runtime": {
          "type": "number",
          "minimum": 0,
          "description": "Total computation time in seconds"
        },
        "status": {
          "type": "string",
          "enum": ["SUCCESS", "PARTIAL_SUCCESS", "FAILED", "TIMEOUT", "CANCELLED"],
          "description": "Overall computation status"
        },
        "error_message": {
          "type": ["string", "null"],
          "description": "Error message if computation failed"
        },
        "warnings": {
          "type": "array",
          "items": {"type": "string"},
          "description": "List of warning messages during computation"
        }
      }
    },
    "polynomial_results": {
      "type": "object",
      "required": ["construction_time", "l2_error", "n_coefficients"],
      "properties": {
        "construction_time": {
          "type": "number",
          "minimum": 0,
          "description": "Time spent constructing polynomial approximation (seconds)"
        },
        "l2_error": {
          "type": "number",
          "minimum": 0,
          "description": "L2 approximation error of the polynomial"
        },
        "condition_number": {
          "type": ["number", "null"],
          "minimum": 1,
          "description": "Condition number of the Vandermonde matrix"
        },
        "n_coefficients": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of polynomial coefficients"
        },
        "n_samples_used": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of sample points actually used"
        },
        "convergence_achieved": {
          "type": "boolean",
          "description": "Whether polynomial construction converged successfully"
        },
        "basis_used": {
          "type": "string",
          "enum": ["chebyshev", "legendre"],
          "description": "Polynomial basis that was actually used"
        },
        "precision_used": {
          "type": "string",
          "description": "Precision type that was actually used"
        },
        "memory_usage_mb": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Peak memory usage during polynomial construction (MB)"
        }
      }
    },
    "critical_point_results": {
      "type": "object",
      "properties": {
        "solving_time": {
          "type": "number",
          "minimum": 0,
          "description": "Time spent solving polynomial system (seconds)"
        },
        "analysis_time": {
          "type": "number",
          "minimum": 0,
          "description": "Time spent analyzing critical points (seconds)"
        },
        "n_raw_solutions": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of solutions from polynomial solver"
        },
        "n_real_solutions": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of real solutions"
        },
        "n_valid_critical_points": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of valid critical points after filtering"
        },
        "n_local_minima": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of identified local minima"
        },
        "convergence_statistics": {
          "type": "object",
          "properties": {
            "n_converged": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points that converged during refinement"
            },
            "n_failed": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points that failed to converge"
            },
            "average_iterations": {
              "type": ["number", "null"],
              "minimum": 0,
              "description": "Average number of BFGS iterations per critical point"
            },
            "max_iterations": {
              "type": ["integer", "null"],
              "minimum": 0,
              "description": "Maximum BFGS iterations for any critical point"
            }
          }
        },
        "function_value_statistics": {
          "type": "object",
          "properties": {
            "min_value": {
              "type": ["number", "null"],
              "description": "Minimum function value found"
            },
            "max_value": {
              "type": ["number", "null"],
              "description": "Maximum function value found"
            },
            "mean_value": {
              "type": ["number", "null"],
              "description": "Mean function value across critical points"
            },
            "global_minimum_value": {
              "type": ["number", "null"],
              "description": "Best (lowest) function value found"
            }
          }
        }
      }
    },
    "hessian_analysis": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether Hessian analysis was performed"
        },
        "computation_time": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Time spent on Hessian computation and analysis (seconds)"
        },
        "classification_counts": {
          "type": "object",
          "properties": {
            "minimum": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points classified as minima"
            },
            "maximum": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points classified as maxima"
            },
            "saddle": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points classified as saddle points"
            },
            "degenerate": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of degenerate critical points"
            },
            "unknown": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical points with unknown classification"
            }
          }
        },
        "eigenvalue_statistics": {
          "type": "object",
          "properties": {
            "min_positive_eigenval": {
              "type": ["number", "null"],
              "description": "Smallest positive eigenvalue across all Hessians"
            },
            "max_negative_eigenval": {
              "type": ["number", "null"],
              "description": "Largest (closest to zero) negative eigenvalue"
            },
            "condition_numbers": {
              "type": "object",
              "properties": {
                "min": {"type": ["number", "null"]},
                "max": {"type": ["number", "null"]},
                "mean": {"type": ["number", "null"]}
              },
              "description": "Statistics on Hessian condition numbers"
            }
          }
        }
      }
    },
    "performance_metrics": {
      "type": "object",
      "properties": {
        "memory_peak_mb": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Peak memory usage during entire computation (MB)"
        },
        "cpu_utilization": {
          "type": ["number", "null"],
          "minimum": 0,
          "maximum": 1,
          "description": "Average CPU utilization (0-1)"
        },
        "disk_io_mb": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Total disk I/O in MB"
        },
        "julia_gc_time": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Time spent in Julia garbage collection (seconds)"
        },
        "julia_compile_time": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Time spent in Julia compilation (seconds)"
        }
      }
    },
    "detailed_results": {
      "type": "object",
      "properties": {
        "critical_points_file": {
          "type": ["string", "null"],
          "description": "Path to detailed critical points CSV file"
        },
        "minima_file": {
          "type": ["string", "null"],
          "description": "Path to detailed minima CSV file"
        },
        "polynomial_coeffs_file": {
          "type": ["string", "null"],
          "description": "Path to polynomial coefficients JSON file"
        },
        "hessian_data_file": {
          "type": ["string", "null"],
          "description": "Path to detailed Hessian analysis file"
        },
        "timing_breakdown_file": {
          "type": ["string", "null"],
          "description": "Path to detailed timing breakdown file"
        }
      }
    },
    "quality_metrics": {
      "type": "object",
      "properties": {
        "approximation_quality": {
          "type": "string",
          "enum": ["excellent", "good", "acceptable", "poor", "failed"],
          "description": "Qualitative assessment of polynomial approximation"
        },
        "critical_point_recovery": {
          "type": "string",
          "enum": ["complete", "partial", "minimal", "failed"],
          "description": "Assessment of critical point finding success"
        },
        "convergence_quality": {
          "type": "string",
          "enum": ["excellent", "good", "acceptable", "poor"],
          "description": "Assessment of optimization convergence quality"
        },
        "overall_success": {
          "type": "boolean",
          "description": "Whether the computation achieved its objectives"
        }
      }
    }
  }
}
